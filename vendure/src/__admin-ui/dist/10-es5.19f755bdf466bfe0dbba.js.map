{"version":3,"sources":["webpack:///src/extensions/ef209228555798f391f578d3e9291891122e76194896b35fec3c371010fe1a66/queries.ts","webpack:///src/extensions/ef209228555798f391f578d3e9291891122e76194896b35fec3c371010fe1a66/block-list.component.html","webpack:///src/extensions/ef209228555798f391f578d3e9291891122e76194896b35fec3c371010fe1a66/block-list.component.ts","webpack:///src/extensions/ef209228555798f391f578d3e9291891122e76194896b35fec3c371010fe1a66/block-detail.component.html","webpack:///src/extensions/ef209228555798f391f578d3e9291891122e76194896b35fec3c371010fe1a66/block-detail.component.ts","webpack:///src/extensions/ef209228555798f391f578d3e9291891122e76194896b35fec3c371010fe1a66/simple-cms.module.ts"],"names":["SIMPLE_CONTENTBLOCK_FRAGMENT","CREATE_CONTENTBLOCK","GET_CONTENTBLOCK","GET_CONTENTBLOCKS","UPDATE_CONTENTBLOCK","DELETE_CONTENTBLOCK","baseDataService","notificationService","blocks","this","query","single$","subscribe","res","simpleContentBlocks","err","error","id","window","confirm","mutate","success","ngOnInit","formBuilder","router","modalService","route","descriptionWordCount","detailForm","group","title","required","slug","description","body","params","block","simpleContentBlock","patchValue","featuredAssetUrl","featuredImage","setValue","replace","toLowerCase","values","getRawValue","console","log","input","featuredAsset","preview","updateSimpleContentBlock","createSimpleContentBlock","navigate","length","fromComponent","size","result","save","$event","preventDefault","updateSlug","countWords","SimpleCmsModule","forChild","path","pathMatch","component","data","breadcrumb"],"mappings":"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","file":"x","sourcesContent":["import gql from 'graphql-tag';\n\nexport const SIMPLE_CONTENTBLOCK_FRAGMENT = gql`\n    fragment SimpleContentBlockFragment on SimpleContentBlock {\n        id\n        createdAt\n        updatedAt\n        author\n        title\n        slug\n        featuredImage\n        description\n        body\n    }`;\n\nexport const CREATE_CONTENTBLOCK = gql`\n    mutation createSimpleContentBlock($input: SimpleContentBlockInput!) {\n        createSimpleContentBlock(input: $input) {\n            ...SimpleContentBlockFragment\n        }\n    }\n    ${SIMPLE_CONTENTBLOCK_FRAGMENT}\n`;\n\nexport const GET_CONTENTBLOCK = gql`\n    query simpleContentBlock($id: ID!) {\n        simpleContentBlock(id: $id) {\n            ...SimpleContentBlockFragment\n        }\n    }\n    ${SIMPLE_CONTENTBLOCK_FRAGMENT}\n`;\n\nexport const GET_CONTENTBLOCKS = gql`\n    query simpleContentBlocks {\n        simpleContentBlocks {\n            ...SimpleContentBlockFragment\n        }\n    }\n    ${SIMPLE_CONTENTBLOCK_FRAGMENT}\n`;\n\nexport const UPDATE_CONTENTBLOCK = gql`\n    mutation updateSimpleContentBlock($id: ID!, $input: SimpleContentBlockInput!) {\n        updateSimpleContentBlock(id: $id, input: $input) {\n            ...SimpleContentBlockFragment\n        }\n    }\n    ${SIMPLE_CONTENTBLOCK_FRAGMENT}\n`;\n\nexport const DELETE_CONTENTBLOCK = gql`\n    mutation deleteSimpleContentBlock($id: ID!) {\n        deleteSimpleContentBlock(id: $id)\n    }\n`;","<vdr-ab-right>\n    <vdr-action-bar-items locationId=\"product-list\"></vdr-action-bar-items>\n    <a class=\"btn btn-primary\" [routerLink]=\"['./create']\" *vdrIfPermissions=\"'CreateCatalog'\">\n        <clr-icon shape=\"plus\"></clr-icon>\n    </a>\n</vdr-ab-right>\n\n<br>\n<br>\n<br>\n<br>\n\n<table style=\"width: 80%;\">\n    <tr *ngFor=\"let block of blocks\">\n        <td [routerLink]=\"block.id\"><a>{{ block.title }}</a></td>\n        <td>\n            <a class=\"btn btn-sml\" (click)=\"delete(block.id)\" >\n                <clr-icon shape=\"trash\" class=\"is-danger\"></clr-icon>\n            </a>\n        </td>\n    </tr>\n</table>\n","import {Component, OnInit} from '@angular/core';\nimport {BaseDataService, NotificationService} from '@vendure/admin-ui/core';\nimport {DELETE_CONTENTBLOCK, GET_CONTENTBLOCKS} from './queries';\n\n@Component({\n    selector: 'content-block-list',\n    templateUrl: './block-list.component.html',\n})\nexport class BlockListComponent implements OnInit {\n\n    blocks = [];\n\n    constructor(\n        private baseDataService: BaseDataService,\n        private notificationService: NotificationService\n    ) {\n    }\n\n    ngOnInit(): void {\n        this.baseDataService.query(GET_CONTENTBLOCKS).single$.subscribe(\n            (res) => this.blocks = (res as any).simpleContentBlocks,\n            err => this.notificationService.error(`Failed to get contentBlocks!`),\n        );\n    }\n\n    delete(id: string) {\n        if (window.confirm(`Are you sure?`)) {\n            this.baseDataService.mutate(DELETE_CONTENTBLOCK, {id}).subscribe(\n                (res) => {\n                    this.notificationService.success(`Deleted`)\n                    this.ngOnInit();\n                },\n                err => this.notificationService.error(`Failed to delete content!`)\n            )\n        }\n    }\n\n\n}","<vdr-ab-right>\n    <button\n            class=\"btn btn-secondary\"\n            *vdrIfPermissions=\"'UpdateCatalog'\"\n            (click)=\"cancel()\"\n    >\n        Cancel\n    </button>\n    <button\n            class=\"btn btn-primary\"\n            (click)=\"save()\"\n            [disabled]=\"detailForm.invalid || detailForm.pristine\"\n    >\n        Save\n    </button>\n</vdr-ab-right>\n\n<form\n        class=\"form\"\n        [formGroup]=\"detailForm\"\n        (keydown.enter)=\"$event.preventDefault()\"\n>\n\n    <vdr-form-field label=\"Featured asset\" for=\"featuredAsset\">\n        <div class=\"card\">\n            <div class=\"card-img\">\n                <div class=\"featured-asset\">\n                    <img\n                            *ngIf=\"featuredAsset\"\n                            [src]=\"featuredAsset | assetPreview:'small' \"\n                            (click)=\"selectFeaturedAsset()\"\n                    />\n                    <p *ngIf=\"featuredAssetUrl && !featuredAsset\">{{ featuredAssetUrl }}</p>\n                    <div class=\"placeholder\" *ngIf=\"!featuredAsset\" (click)=\"selectFeaturedAsset()\">\n                        <clr-icon shape=\"image\" size=\"128\"></clr-icon>\n                        <div>{{ 'catalog.no-featured-asset' | translate }}</div>\n                    </div>\n                </div>\n            </div>\n            <div class=\"card-block\"><ng-container ></ng-container></div>\n            <div class=\"card-footer\" *vdrIfPermissions=\"'UpdateCatalog'\">\n                <button class=\"btn\" (click)=\"selectFeaturedAsset()\">\n                    <clr-icon shape=\"attachment\"></clr-icon>\n                    {{ 'asset.add-asset' | translate }}\n                </button>\n            </div>\n        </div>\n    </vdr-form-field>\n\n    <vdr-form-field label=\"Title\" for=\"title\">\n        <input\n                id=\"title\"\n                type=\"text\"\n                formControlName=\"title\"\n                (input)=\"updateSlug($event.target.value)\"\n        />\n    </vdr-form-field>\n    <vdr-form-field label=\"Slug\" for=\"slug\">\n        <input\n                id=\"slug\"\n                type=\"text\"\n                formControlName=\"slug\"\n        />\n    </vdr-form-field>\n    <vdr-form-field label=\"SEO description ({{ descriptionWordCount }}) \" for=\"description\">\n        <textarea id=\"description\" formControlName=\"description\" style=\"width: 100%\" (input)=\"countWords()\"></textarea>\n    </vdr-form-field>\n    <vdr-rich-text-editor\n            id=\"contentBlockRte\"\n            formControlName=\"body\"\n            label=\"Content body\"\n    ></vdr-rich-text-editor>\n\n\n</form>","import {Component, OnInit} from '@angular/core';\nimport {ActivatedRoute, Router} from '@angular/router';\nimport {FormBuilder, FormGroup, Validators} from '@angular/forms';\nimport {\n    Asset,\n    AssetPickerDialogComponent,\n    BaseDataService,\n    ModalService,\n    NotificationService\n} from '@vendure/admin-ui/core';\nimport {CREATE_CONTENTBLOCK, GET_CONTENTBLOCK, UPDATE_CONTENTBLOCK} from './queries';\n\n@Component({\n    selector: 'content-block-detail',\n    styleUrls: ['./block-detail.component.scss'],\n    templateUrl: './block-detail.component.html',\n})\nexport class BlockDetailComponent implements OnInit {\n\n    detailForm: FormGroup;\n    descriptionWordCount = 0;\n    featuredAsset?: Asset;\n    featuredAssetUrl?: string\n    id?: string;\n\n    constructor(\n        private formBuilder: FormBuilder,\n        private router: Router,\n        private modalService: ModalService,\n        private baseDataService: BaseDataService,\n        private notificationService: NotificationService,\n        private route: ActivatedRoute,\n    ) {\n        this.detailForm = this.formBuilder.group({\n            title: ['', Validators.required],\n            slug: '',\n            description: '',\n            body: ['', Validators.required]\n        });\n    }\n\n    ngOnInit(): void {\n        this.route.params.subscribe(params => {\n            this.id = params.id;\n            if (!this.id) {\n                return;\n            }\n            this.baseDataService.query(GET_CONTENTBLOCK, {id: this.id}).single$.subscribe(\n                (res) => {\n                    const block = (res as any).simpleContentBlock;\n                    this.detailForm.patchValue({\n                        title: block.title,\n                        slug: block.slug,\n                        description: block.description,\n                        body: block.body\n                    });\n                    this.featuredAssetUrl = block.featuredImage;\n                },\n                err => this.notificationService.error(`Failed to get block ${this.id}`)\n            );\n        });\n    }\n\n    updateSlug(title: string): void {\n        if (!title) {\n            return this.detailForm.setValue({slug: ''});\n        }\n        this.detailForm.patchValue({slug: title.replace(/\\s+/g, '-').toLowerCase()});\n    }\n\n    save(): void {\n        const values = this.detailForm.getRawValue();\n        console.log('ID', this.id);\n        const input = {\n            featuredImage: this.featuredAsset?.preview,\n            title: values.title,\n            slug: values.slug,\n            description: values.description,\n            body: values.body\n        };\n        if (this.id) {\n            this.baseDataService.mutate(UPDATE_CONTENTBLOCK, {\n                id: this.id,\n                input\n            }).subscribe(\n                (res) => {\n                    this.id = (res as any)?.updateSimpleContentBlock?.id;\n                    this.notificationService.success(`Saved`);\n                },\n                err => this.notificationService.error(`Failed to update content!`),\n            );\n        } else {\n            this.baseDataService.mutate(CREATE_CONTENTBLOCK, {\n                input\n            }).subscribe(\n                (res) => {\n                    this.id = (res as any)?.createSimpleContentBlock?.id;\n                    this.notificationService.success(`Saved`);\n                },\n                err => this.notificationService.error(`Failed to update content!`),\n            );\n        }\n    }\n\n    cancel(): void {\n        if (window.confirm(`Are you sure?`)) {\n            this.router.navigate(['../extensions/simple-cms']);\n        }\n    }\n\n    countWords(): void {\n        this.descriptionWordCount = this.detailForm.getRawValue().description?.length || 0\n    }\n\n    selectFeaturedAsset(): void {\n        this.modalService\n            .fromComponent(AssetPickerDialogComponent, {\n                size: 'xl',\n            })\n            .subscribe(result => {\n                if (result && result.length) {\n                    // this.assets = unique(this.assets.concat(result), 'id');\n                    this.featuredAsset = result[0];\n                }\n            });\n    }\n\n}","import {NgModule} from '@angular/core';\nimport {RouterModule} from '@angular/router';\nimport {SharedModule} from '@vendure/admin-ui/core';\nimport {BlockListComponent} from './block-list.component';\nimport {BlockDetailComponent} from './block-detail.component';\n\n@NgModule({\n    imports: [\n        SharedModule,\n        RouterModule.forChild([{\n            path: '',\n            pathMatch: 'full',\n            component: BlockListComponent,\n            data: {breadcrumb: 'Content'},\n        }, {\n            path: 'create',\n            pathMatch: 'full',\n            component: BlockDetailComponent,\n            data: {breadcrumb: 'Content'},\n        }, {\n            path: ':id',\n            pathMatch: 'full',\n            component: BlockDetailComponent,\n            data: {breadcrumb: 'Content'},\n        }]),\n    ],\n    declarations: [BlockListComponent, BlockDetailComponent],\n})\nexport class SimpleCmsModule {\n}"]}